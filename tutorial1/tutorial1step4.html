<!DOCTYPE HTML>
<html>
	<head>
		<title>Personal webpage of Simon Gravelle</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36911186-4"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'UA-36911186-4');
		</script>
	</head>
	<body class="is-preload">
			<div id="wrapper">
					<div id="main">
						<div class="inner">
								<header id="header">
									<a href="../index.html" class="logo"><strong>Personal webpage</strong> of Simon Gravelle</a>
									<ul class="icons">
									<li><a href="https://twitter.com/GravelleSimon" target="_blank" class="removelinkdefault"><strong class="fab fa-twitter"></strong></a></li>
									<li><a href="https://github.com/simongravelle" target="_blank" class="removelinkdefault"><strong class="fab fa-github"></strong></a></li>
									<li><a href="https://scholar.google.com/citations?user=9fD2JlYAAAAJ&hl=fr" target="_blank" class="removelinkdefault"><strong class="fa fa-graduation-cap"></strong></a></li>
									<li><a href="https://orcid.org/0000-0003-2149-6706" target="_blank" class="removelinkdefault"><strong>iD</strong></a></li>
									<li><a href="https://www.youtube.com/channel/UCLmK_9wpyLVpcP7BPgN6BIw?view_as=subscriber" target="_blank" class="removelinkdefault"><strong class="fab fa-youtube"></strong></a></li>
									</ul>
								</header>
								<section>
									<header class="major">
										<h2>Step 4: equilibration</h2>
									</header>									
	
										<strong>
												
										
										Starting from the final configuration of the minisation step, we can now run the molecular dynamics simulation. Here we are going to let the system evolve freely until it reaches an equilibrium. Let us create a new input file and call it input.03.lammps. Add the following lines:
										
<code>
<pre>
# LAMMPS input script

boundary	p p p
units		real
atom_style	full
bond_style	harmonic
angle_style	harmonic
pair_style	lj/cut/tip4p/long 1 2 1 1 0.1546 12.0
kspace_style	pppm/tip4p 1.0e-4

read_data	data.02.lammps
include		PARM.lammps

group		gH2O type 1 2
group		gNa type 3
group		gCl type 4
group		gliquid type 1 2 3 4
group		gtopwall type 5
group		gbotwall type 6

fix		mysf1 gtopwall setforce 0 0 NULL
fix		mysf2 gbotwall setforce 0 0 NULL
fix		myaf1 gtopwall aveforce NULL NULL 0
fix		myaf2 gbotwall aveforce NULL NULL 0
neigh_modify 	exclude group gtopwall gtopwall
neigh_modify 	exclude group gbotwall gbotwall

fix		mynve all nve
compute		tliq gliquid temp
fix		myber gliquid temp/berendsen 300 300 100
fix_modify	myber temp tliq

fix		myshk gH2O shake 1.0e-4 200 0 b 1 a 1
fix		myrct all recenter NULL NULL INIT

dump 		mydmp all atom 1000 dump.03.lammpstrj

timestep	1.0
thermo		5000
thermo_modify 	temp tliq
run		50000

write_data	data.03.lammps
</pre>
</code>			

										The two main diffences with the previous step are the timestep and the thermostating. Now the desired temperature is 300 K, and the fluid is expected to behave as a liquid. In addition, the timestep is now equal to 1 fs, a value that is classic for these force field. The result of the simulation is the following:
										
										<br><br>
										
										<span class="image object">
											  <video autoplay loop muted playsinline poster="/images/animationalternative.jpg">
											  <source src="video3.webm" type="video/webm">
											  <source src="video3.mp4" type="video/mp4">
											</video>
										</span>
										
										<br><br>
										
										The fluid quickly forms a dense liquid. The final state of the simulation will be used as the starting point for more interesting simulations.	It may take a few hours to run the full simulation. Alternatively, you can download the final <a href="data.03.lammps" target="_blank" class="removelinkdefault">'data.03.lammps' file here</a>.
									<br><br>
										</strong>
										
																			
									<ul class="pagination">
										<li><a href="tutorial1step3.html" class="button">Prev</a></li>
										<li><a href="tutorial1step1.html" class="page">1</a></li>
										<li><a href="tutorial1step2.html" class="page">2</a></li>
										<li><a href="tutorial1step3.html" class="page">3</a></li>
										<li><a href="tutorial1step4.html" class="page active">4</a></li>
										<li><span class="button disabled">Next</span></li>
									</ul>
								</section>
						</div>
					</div>
					<div id="sidebar">
						<div class="inner">
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="../index.html">Homepage</a></li>
										<li><a href="../publications.html">List of publications</a></li>
										<li><a href="../curriculum.html">Curriculum</a></li>
									</ul>
								</nav>
								<section>
									<header class="major">
										<h2><a href="../molecularsimulationtutorials.html" class="removelinkdefault">Simulation tutorial</h2></a>
									</header>
									<div class="mini-posts">
										<article>
											<p><a href="../molecularsimulationtutorials.html" target="_blank" class="removelinkdefault">Find my molecular simulation tutorial (LAMMPS).</a></p>
										</article>
									</div>
									<header class="major">
										<h2><a href="https://github.com/simongravelle/LAMMPS/tree/main/WaterInCNT" target="_blank" class="removelinkdefault">Open-source codes</h2></a>
									</header>	
									<div class="mini-posts">
										<article>
												<a href="https://github.com/simongravelle/LAMMPS/tree/main/WaterInCNT" class="image"><img src="images/waterinCNT.gif" alt="" /></a>
											<p><a href="https://github.com/simongravelle/LAMMPS/tree/main/WaterInCNT" target="_blank" class="removelinkdefault">Monte Carlo grand canonique and molecular dynamics simulations with LAMMPS: water molecule in an effectively infinite flexible carbon nanotube.</a></p>
										</article>
									</div>
									<ul class="actions">
										<li><a href="https://github.com/simongravelle/LAMMPS" class="removelinkdefault" target="_blank"><strong>Find All my codes on Github</strong></a></li>
									</ul>
								</section>
								<section>
									<header class="major">
										<h2>Get in touch</h2>
									</header>
									<p>Feel free to contact me if you have any questions about my work. </p>
									<ul class="contact">
										<li class="icon solid fa-envelope">s.gravelle at qmul.ac.uk</li>
										<!--<li class="icon solid fa-phone">(000) 000-0000</li>-->
										<li class="icon solid fa-home">Queen Mary University of London <br> Mile End Rd <br> Bethnal Green <br>London E1 4NS</li>
									</ul>
								</section>
								<footer id="footer">
									<p class="copyright">Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>

						</div>
					</div>
			</div>
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

	</body>
</html>

<!-- if you waant to make my day, you can send me feedback and help me improve this tutorial. -->
