<!DOCTYPE HTML>
<html>
	<head>
		<title>Personal webpage of Simon Gravelle</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36911186-4"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'UA-36911186-4');
		</script>
	</head>
	<body class="is-preload">
			<div id="wrapper">
					<div id="main">
						<div class="inner">
								<header id="header">
									<a href="../index.html" class="logo"><strong>Personal webpage</strong> of Simon Gravelle</a>
									<ul class="icons">
									<li><a href="https://twitter.com/GravelleSimon" target="_blank" class="removelinkdefault"><strong class="fab fa-twitter"></strong></a></li>
									<li><a href="https://github.com/simongravelle" target="_blank" class="removelinkdefault"><strong class="fab fa-github"></strong></a></li>
									<li><a href="https://scholar.google.com/citations?user=9fD2JlYAAAAJ&hl=fr" target="_blank" class="removelinkdefault"><strong class="fa fa-graduation-cap"></strong></a></li>
									<li><a href="https://orcid.org/0000-0003-2149-6706" target="_blank" class="removelinkdefault"><strong>iD</strong></a></li>
									<li><a href="https://www.youtube.com/channel/UCLmK_9wpyLVpcP7BPgN6BIw?view_as=subscriber" target="_blank" class="removelinkdefault"><strong class="fab fa-youtube"></strong></a></li>
									</ul>
								</header>
								<section>
									<header class="major">
										<h2>Step 5 : measurements</h2>
									</header>									
	
										<strong>
										Once the system is equilibrated, interesting measurements can be performed. There are two kinds of measurements that are typically performed in molecular dynamics: equilibrium and out-of-equilibrium measurements. Let us see one example of each.
										
										<br><br>
										
										<h2>Equilibrium measurement</h2>
										
										Equilibrium measurements consist in extracting data from an unperturbed system. Starting from the previous equilibrated system, one could simply extract the force applied by the fluid on the walls. To do so, we can use the ave/time command that we already used to extract the energy in Step 3, and extract the force along x and y that is given by the fixes "setforce" :
<code>
<pre>

# LAMMPS input script

boundary	p p p
units		real
atom_style	full
bond_style	harmonic
angle_style	harmonic
pair_style	lj/cut/tip4p/long 1 2 1 1 0.1546 12.0
kspace_style	pppm/tip4p 1.0e-4

read_data	data.03.lammps
include		PARM.lammps

group		gH2O type 1 2
group		gNa type 3
group		gCl type 4
group		gliquid type 1 2 3 4
group		gtopwall type 5
group		gbotwall type 6

fix		mysf1 gtopwall setforce 0 0 NULL
fix		mysf2 gbotwall setforce 0 0 NULL
fix		myaf1 gtopwall aveforce NULL NULL 0
fix		myaf2 gbotwall aveforce NULL NULL 0
neigh_modify 	exclude group gtopwall gtopwall
neigh_modify 	exclude group gbotwall gbotwall

fix		mynve all nve
compute		tliq gliquid temp
fix		myber gliquid temp/berendsen 300 300 100
fix_modify	myber temp tliq

fix		myshk gH2O shake 1.0e-4 200 0 b 1 a 1
fix		myrct all recenter NULL NULL INIT

fix		myavt1 all ave/time 10 1 10 f_mysf1[1] f_mysf2[1] file data.04_forceX.dat
fix		myavt2 all ave/time 10 1 10 f_mysf1[2] f_mysf2[2] file data.04_forceY.dat

dump 		mydmp all atom 1000 dump.04.lammpstrj

timestep	1.0
thermo		5000
thermo_modify 	temp tliq
run		50000
</pre>
</code>		 
		
This way, the forces along X applied by the fluid on the top wall (f_mysf1[1]) and bottom wall (f_mysf2[1]) are extrated and printed in data.04_forceX.dat every 10 timesteps. From the temporal correlation of the force versus time signal, you can extract the friction coefficient, from which it is possible to deduce the hydrodynamic slip length. 
</strong>
<br><br>
										
<h2>Out-of-equilibrium measurement</h2>
<strong>
<br><br>
Out-of-equilibirum measurements consist in applying a force the system, and measuring how the system react to the forcing. With the present system, we can for example apply a force (parallel to the walls) to the fluid. The fluid will acceletate and reach a constant average velocity in the direction of the force. 

<code>
<pre>

# LAMMPS input script

boundary	p p p
units		real
atom_style	full
bond_style	harmonic
angle_style	harmonic
pair_style	lj/cut/tip4p/long 1 2 1 1 0.1546 12.0
kspace_style	pppm/tip4p 1.0e-4

read_data	data.03.lammps
include		PARM.lammps

group		gH2O type 1 2
group		gNa type 3
group		gCl type 4
group		gliquid type 1 2 3 4
group		gtopwall type 5
group		gbotwall type 6

fix		mysf1 gtopwall setforce 0 0 NULL
fix		mysf2 gbotwall setforce 0 0 NULL
fix		myaf1 gtopwall aveforce NULL NULL 0
fix		myaf2 gbotwall aveforce NULL NULL 0
neigh_modify 	exclude group gtopwall gtopwall
neigh_modify 	exclude group gbotwall gbotwall

fix		mynve all nve
compute		tliq gliquid temp
fix		myber gliquid temp/berendsen 300 300 100
fix_modify	myber temp tliq

fix 		myadf gliquid addforce 1e-5 0.0 0.0

fix		myshk gH2O shake 1.0e-4 200 0 b 1 a 1
fix		myrct all recenter NULL NULL INIT

variable	velx equal vcm(gH2O,x)
fix		myavt all ave/time 10 100 1000 v_velx file data.04_velLiqX.dat
fix		myavt1 all ave/time 10 100 1000 f_mysf1[1] f_mysf2[1] file data.04_forceX.dat

dump 		mydmp all atom 1000 dump.04.lammpstrj

timestep	1.0
thermo		5000
thermo_modify 	temp tliq
run		50000
</pre>
</code>

The addforce command adds a force to the fluide (ions + water molecules) in the x direction. From the average value of the force applied by the fluid on the wall in the direction of the flow, the friction coefficient can be calculated. Note that the system needs time to reach a "new equilibrium" in presence of the force. If you plot the fluid velocity as a function of the time (from data.04_velLiqX.dat), you should see the velocity slowly converging toward its equilibrium value.




















 

										
</strong>
										
																			
									<ul class="pagination">
										<li><a href="tutorial1step4.html" class="button">Prev</a></li>
										<li><a href="tutorial1step1.html" class="page">1</a></li>
										<li><a href="tutorial1step2.html" class="page">2</a></li>
										<li><a href="tutorial1step3.html" class="page">3</a></li>
										<li><a href="tutorial1step4.html" class="page">4</a></li>
										<li><a href="tutorial1step5.html" class="page active">5</a></li>
										<li><span class="button disabled">Next</span></li>
									</ul>
								</section>
						</div>
					</div>
					<div id="sidebar">
						<div class="inner">
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="../index.html">Homepage</a></li>
										<li><a href="../publications.html">List of publications</a></li>
										<li><a href="../curriculum.html">Curriculum</a></li>
									</ul>
								</nav>
								<section>
									<header class="major">
										<h2><a href="../molecularsimulationtutorials.html" class="removelinkdefault">Tutorials</h2></a>
									</header>
									<header class="major">
										<h2><a href="https://www.youtube.com/channel/UCLmK_9wpyLVpcP7BPgN6BIw" target="_blank class="removelinkdefault">Youtube channel</h2></a>
									</header>
									<header class="major">
										<h2><a href="https://github.com/simongravelle/LAMMPS/tree/main/WaterInCNT" target="_blank" class="removelinkdefault">Open-source codes</h2></a>
									</header>	
									<div class="mini-posts">
										<article>
												<a href="https://github.com/simongravelle/LAMMPS/tree/main/WaterInCNT" class="image"><img src="../images/waterinCNT.gif" alt="" /></a>
											<p><a href="https://github.com/simongravelle/LAMMPS/tree/main/WaterInCNT" target="_blank" class="removelinkdefault">Monte Carlo grand canonique and molecular dynamics simulations with LAMMPS: water molecule in an effectively infinite flexible carbon nanotube.</a></p>
										</article>
									</div>
									<ul class="actions">
										<li><a href="https://github.com/simongravelle/LAMMPS" class="removelinkdefault" target="_blank"><strong>Find All my codes on Github</strong></a></li>
									</ul>
								</section>
								<section>
									<header class="major">
										<h2>Get in touch</h2>
									</header>
									<p>Feel free to contact me if you have any questions about my work. </p>
									<ul class="contact">
										<li class="icon solid fa-envelope">s.gravelle at qmul.ac.uk</li>
										<!--<li class="icon solid fa-phone">(000) 000-0000</li>-->
										<li class="icon solid fa-home">Queen Mary University of London <br> Mile End Rd <br> Bethnal Green <br>London E1 4NS</li>
									</ul>
								</section>
								<footer id="footer">
									<p class="copyright">Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>

						</div>
					</div>
			</div>
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

	</body>
</html>

<!-- if you waant to make my day, you can send me feedback and help me improve this tutorial. -->
