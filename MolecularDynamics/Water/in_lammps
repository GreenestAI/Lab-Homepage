# LAMMPS input file

# define the simulation temperature in Kelvin
variable        tmp equal 273.15+20.0
# we defined the unit as real, so dimentions are in angstrom, time in femtosecond
units           real
# we define periodic boundary conditions in all 3 direction (in z as well because of the kspace)
boundary        p p p
# the atom style is "full", to allow for bonds, angles, or charges, all important for water
atom_style      full
# bond and angle styles are harmonic
bond_style      harmonic
angle_style     harmonic
# we use a pair style made specifically for tip4p water molecule. the pair style automatically creates a fourth massless atom at a distance 0.1546 from the oxygen. See for example the wikipedia page for water models: https://en.wikipedia.org/wiki/Water_model. The cut-off of 14 angstroms is a bit longuer than usual (10 angstroms).
pair_style     	lj/cut/tip4p/long 1 2 1 1 0.1546 14
# we shift the Lennard-Jones potential is shifted to 0.0 at its cutoff. I choose arithmetic so sigma_ij = (sigma_i + sigma_j) / 2, but it should not mater for a water only simulation
pair_modify     mix arithmetic tail yes
# a long-range solver for Coulombic interactions made for TIP4P water model
kspace_style 	pppm/tip4p 1.0e-4
# load the data file generated by the python script, which include the definition of the box, the atom position, the location of the bond and angle beyond others
read_data	data.lammps
# load the parameter file containing the parameters of the water model (pair coef, bond, angle)
include 	PARM.FILE
# I keep the default value of neighbor interaction (neighbor 2.0 bin and neigh_modify delay 10 every 1 check  yes
# I use shake to preserve the shape of water molecules
fix 		shak all shake 1.0e-4 200 0 b 1 a 1
# an initial velocity to water molecules is given to water molecule
velocity 	all create ${tmp} 4928459 rot yes dist gaussian
# a dump allow to visualise the simulation
dump 		dp1 all atom 1000 dump.water.lammpstrj
dump_modify	dp1 flush yes
# the molecules temperature is maintained with a nvt thermostat
fix 		fnp all nvt temp ${tmp} ${tmp} 100.0
# molecules are maintained at the center of the box (does not affect the dynamics)
fix		rc1 all recenter NULL NULL INIT
# finally fixe the timestep (2fs is common, in part thank to the shake algorithm)
thermo          1000
timestep        2.0
run		100000



